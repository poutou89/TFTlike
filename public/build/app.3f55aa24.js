/*! For license information please see app.3f55aa24.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[524],{633:()=>{document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("register_type_form_plainPassword_first"),t=document.getElementById("register_type_form_plainPassword_second"),n=document.getElementById("register-btn");function r(){e.value&&e.value===t.value?n.disabled=!1:n.disabled=!0}e&&t&&n&&(e.addEventListener("input",r),t.addEventListener("input",r))})},1738:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n(2675),n(9463),n(2259),n(5700),n(6280),n(6918),n(8107),n(8706),n(2008),n(113),n(1629),n(3418),n(4423),n(4346),n(3792),n(8598),n(2062),n(4114),n(4782),n(9572),n(3288),n(2010),n(6033),n(2892),n(7945),n(4185),n(3851),n(1278),n(9432),n(6099),n(8940),n(7495),n(906),n(8781),n(7357),n(1699),n(7764),n(1761),n(5440),n(2762),n(8992),n(4520),n(2577),n(3949),n(1454),n(3500),n(2953),n(6031),document.addEventListener("DOMContentLoaded",function(){var e,t,n;if(document.body.classList.contains("page-match")){var r=(window.ASSET_BASE||"/").replace(/\/?$/,"/"),a=function(e){var t=String(e||"");return t?/^(?:https?:|data:|blob:)/i.test(t)?t:r+t.replace(/^\/+/,""):""},o=document.getElementById("board"),s=document.getElementById("battle-log"),u=document.getElementById("hud-allies"),d=document.getElementById("hud-enemies"),m=document.getElementById("hud-allies-title"),f=document.getElementById("hud-enemies-title"),v=document.getElementById("btn-start"),p=document.getElementById("btn-pause"),g=document.getElementById("btn-reset"),y=document.getElementById("btn-music");if(o&&s&&u&&d&&v&&p&&g){var h=JSON.parse((null===(e=document.getElementById("replay-json"))||void 0===e?void 0:e.textContent)||"{}"),b=JSON.parse((null===(t=document.getElementById("allies-json"))||void 0===t?void 0:t.textContent)||"[]"),S=JSON.parse((null===(n=document.getElementById("enemies-json"))||void 0===n?void 0:n.textContent)||"[]");if(h&&Array.isArray(h.initial)){console.debug("REPLAY:",h,"allyCount=",h.initial.filter(function(e){return"ally"===e.team}).length,"enemyCount=",h.initial.filter(function(e){return"enemy"===e.team}).length);var w=new Map,E=null,L=0,_=null,A=!0,T=!1,M=window.BGM_URL;M&&((_=new Audio(M)).loop=!0,_.preload="auto",_.volume=0),y&&(_||(y.disabled=!0,y.title="Aucune musique disponible"),y.setAttribute("aria-pressed",A?"true":"false"),y.addEventListener("click",function(){A=!A,y.setAttribute("aria-pressed",A?"true":"false"),_&&(A?_.play().catch(function(){}):_.pause())}));var I=function(e,t){return o.querySelector('.cell[data-x="'.concat(e,'"][data-y="').concat(t,'"]'))},x=h.ally_username||h.ally_name||R(b)||h.player_ally||N(),k=h.enemy_username||h.enemy_name||R(S)||h.player_enemy||N();m&&(m.textContent=x),f&&(f.textContent=k);var C=new Map,O=z(b),j=z(S),B=Array.isArray(window.ITEMS)?window.ITEMS:[],P=function(e){var t=String(e||"").trim();if(!t)return"";var n=t.match(/\.[a-z0-9]+$/i),r=!!n,a=r?t.replace(/\.[a-z0-9]+$/i,""):t;return"images/items/"+(/^\d+$/.test(a)?"fc"+a:a)+(r?n[0]:".png")};v.addEventListener("click",function(){E||(E=setInterval(V,400)),_&&(A=!0,y&&y.setAttribute("aria-pressed","true"),_.currentTime=0,_.play().then(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(_){T=!1;var n=_.volume,r=performance.now(),a=function(i){var o=Math.min(1,(i-r)/e);_.volume=n+(t-n)*o,o<1&&requestAnimationFrame(a)};requestAnimationFrame(a)}}(450,.5)}).catch(function(e){console.debug("bgm play blocked",e)}))}),p.addEventListener("click",function(){E&&(clearInterval(E),E=null),q()}),g.addEventListener("click",function(){E&&(clearInterval(E),E=null),L=0,$(),_&&(q(),_.currentTime=0)}),$()}else console.warn("No replay provided")}else console.warn("Match UI missing",{board:o,logEl:s,hudA:u,hudE:d,btnStart:v,btnPause:p,btnReset:g})}function q(){_&&_.pause()}function H(e){if(e){var t=document.createElement("div");t.textContent=e,s.appendChild(t),s.scrollTop=s.scrollHeight}}function N(){var e=["Airi","Mika","Yuna","Nia","Hana","Suki","Luna","Momo","Rin","Saya","Kira","Nova","Zoe","Aya"],t=["Fox","Star","Bloom","Dash","Wave","Heart","Spark","Song","Dream","Moon","Sky","Shine"];return e[Math.floor(Math.random()*e.length)]+" "+t[Math.floor(Math.random()*t.length)]}function R(e){if(e){if(Array.isArray(e)){var t=e[0]||{};return t.owner_name||t.username||t.player||t.user||t.owner||void 0}return e.owner_name||e.username||e.player||e.user||e.owner||void 0}}function D(){var e=function(e){return l(w.values()).filter(function(t){return t.team===e}).map(function(e){var t=Array.isArray(e.families)?e.families:[],n=Array.isArray(e.items)?e.items:[],r=Array.isArray(window.ITEMS)?window.ITEMS:[],i=function(e){if(null==e)return null;var t=Number(e);return!isFinite(t)||t<=0?null:(t>1&&(t/=100),Math.round(100*t))},o=n.map(function(e){if("string"==typeof e){var t=e.trim();if(/^(?:https?:|data:|blob:|\/)/i.test(t)||t.includes("/"))return{img:t};var n=t.replace(/\.[a-z0-9]+$/i,""),a=r.find(function(e){return String(e.id)===String(n)});return!a&&/^\d+$/.test(n)&&(a=r.find(function(e){return String(e.id)==="fc"+n})),a||{img:P(t)}}if("number"==typeof e){var i=String(e);return r.find(function(e){return String(e.id)===i})||r.find(function(e){return String(e.id)==="fc"+i})||{img:P(e)}}return!e||!e.id||e.img||e.icon||e.image?e||{}:r.find(function(t){return String(t.id)===String(e.id)})||e}),c=null!=e.armor&&Number(e.armor)>0?" ‚Ä¢ üõ°Ô∏è".concat(e.armor):"",l=i(e.acc),s=i(e.crit),u=i(e.dodge),d=null!=l?" ‚Ä¢ üéØ".concat(l,"%"):"",m=null!=s?" ‚Ä¢ ‚ú∂".concat(s,"%"):"",f=null!=u?" ‚Ä¢ üëü".concat(u,"%"):"",v="".concat(e.hp," PV").concat(e.shield>0?" ‚Ä¢ üõ°".concat(e.shield):"").concat(e.mana>0?" ‚Ä¢ üî∑".concat(e.mana):"").concat(e.atk?" ‚Ä¢ ‚öîÔ∏è".concat(e.atk):"").concat(c).concat(d).concat(m).concat(f),p=o.map(function(e){var t=e&&(e.icon||e.img||e.image);return t?'<img class="item" src="'.concat(a(t),'" title="').concat(e.name||"",'" alt="">'):""}).join(""),g=t.map(function(e){return'<span class="tag" title="'.concat(e.name||e,'">').concat(e.short||e.name||e,"</span>")}).join("");return'<li>\n          <div class="hud-ava"><img src="'.concat(a(e.img),'" alt=""></div>\n          <div class="hud-name">').concat(e.name,'</div>\n          <div class="hud-stats">').concat(v,'</div>\n          <div class="hud-meta">').concat(p).concat(g,"</div>\n        </li>")}).join("")};u.innerHTML=e("ally"),d.innerHTML=e("enemy")}function F(e){var t=e.el.querySelector(".hp");t&&(t.textContent=e.hp);var n=e.el.querySelector(".shield");n&&(n.textContent=e.shield,n.style.display=e.shield>0?"":"none");var r=e.el.querySelector(".mana");r&&(r.textContent=e.mana,r.style.display=e.mana>0?"":"none");var a=e.el.querySelector(".u-bar--hp > span"),i=e.el.querySelector(".u-bar--mana > span");if(a){var o=Math.max(1,e.maxHp||e.hp||1),c=Math.max(0,Math.min(o,e.hp||0));a.style.width=Math.round(100*c/o)+"%"}if(i){var l=Math.max(0,Math.min(50,e.mana||0));i.style.width=Math.round(100*l/50)+"%"}}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:120;try{if(!e)return;var a=performance.now();if(a-(C.get(n)||0)<r)return;C.set(n,a);var i=new Audio(e);i.volume=t,i.play().catch(function(){})}catch(e){}}function J(e){return e?(Array.isArray(e)?e:[e]).map(function(e){return e}):[]}function X(e){return e?(Array.isArray(e)?e:[e]).map(function(e){return"string"==typeof e?{name:e,short:String(e).slice(0,3).toUpperCase()}:e}):[]}function z(e){var t=new Map,n=new Map;if(!Array.isArray(e))return{byId:t,byName:n};var r,a=c(e);try{for(a.s();!(r=a.n()).done;){var i,o,l,s,u,d,m,f,v=r.value,p=null!==(i=null!==(o=null==v?void 0:v.id)&&void 0!==o?o:null==v?void 0:v.unit_id)&&void 0!==i?i:null==v?void 0:v.girl_id,g=null!==(l=null==v?void 0:v.name)&&void 0!==l?l:null==v?void 0:v.girl_name,y={items:J(null!==(s=null!==(u=null==v?void 0:v.items)&&void 0!==u?u:null==v?void 0:v.item)&&void 0!==s?s:null==v?void 0:v.item_id),families:X(null!==(d=null==v?void 0:v.families)&&void 0!==d?d:null==v?void 0:v.family),focus_y:null!==(m=null!==(f=null==v?void 0:v.focus_y)&&void 0!==f?f:null==v?void 0:v.focusY)&&void 0!==m?m:null==v?void 0:v.foc_y};null!=p&&t.set(String(p),y),g&&n.set(String(g).toLowerCase(),y)}}catch(e){a.e(e)}finally{a.f()}return{byId:t,byName:n}}function $(){o.querySelectorAll(".cell").forEach(function(e){return e.innerHTML=""}),s.innerHTML="",w.clear();var e,t=c(h.initial);try{for(t.s();!(e=t.n()).done;){var n=i({},e.value),r="ally"===n.team?O:j,l=r.byId.get(String(n.id))||(n.name?r.byName.get(String(n.name).toLowerCase()):null)||null;l?(Array.isArray(n.items)||(n.items=l.items||[]),Array.isArray(n.families)||(n.families=l.families||[]),null==n.focus_y&&null!=l.focus_y&&(n.focus_y=l.focus_y)):n.item&&!n.items&&(n.items=J(n.item)),Array.isArray(n.items)&&(n.items=n.items.map(function(e){if("number"==typeof e){var t=String(e);return B.find(function(e){return String(e.id)===t})||B.find(function(e){return String(e.id)==="fc"+t})||{img:P(t)}}if("string"==typeof e){var n=e.trim();if(/^(?:https?:|data:|blob:|\/)/i.test(n)||n.includes("/"))return{img:n};var r=n.replace(/\.[a-z0-9]+$/i,"");return B.find(function(e){return String(e.id)===String(r)})||(/^\d+$/.test(r)?B.find(function(e){return String(e.id)==="fc"+r}):null)||{img:P(n)}}return!e||!e.id||e.img||e.icon||e.image?e:B.find(function(t){return String(t.id)===String(e.id)})||e}));var u=document.createElement("div");u.className="unit unit--".concat(n.team," unit--").concat(n.class);var d=n.focus_y;"number"!=typeof d?d=.2:d>1&&(d/=100),u.innerHTML='\n    <img src="'.concat(a(n.img),'" alt="" style="object-position:center ').concat(Math.round(100*d),'%">\n    <div class="u-bars">\n      <div class="u-bar u-bar--hp"><span></span></div>\n      <div class="u-bar u-bar--mana"><span></span></div>\n    </div>\n  ').concat(Array.isArray(n.items)&&n.items.length?'<div class="u-items">'.concat(n.items.map(function(e){var t=(null==e?void 0:e.icon)||(null==e?void 0:e.img)||(null==e?void 0:e.image)||"";return t?'<img src="'.concat(a(t),'" alt="" title="').concat(e.name||"",'">'):""}).join(""),"</div>"):"");var m=I(n.x,n.y);m&&m.appendChild(u),n.el=u,w.set(n.id,n),F(n)}}catch(e){t.e(e)}finally{t.f()}D()}function V(){var e;if(L>=((null===(e=h.actions)||void 0===e?void 0:e.length)||0)){clearInterval(E),E=null;var t="ally"===h.winner?"victory":"enemy"===h.winner?"defeat":"draw";H("victory"===t?"Victoire !":"defeat"===t?"D√©faite‚Ä¶":"√âgalit√© !");var n=document.getElementById("result-overlay"),r=document.getElementById("result-text"),i=document.getElementById("btn-result-continue"),o=document.getElementById("result-sound-toggle");if(n&&r){var c;if(n.classList.remove("is-hidden"),n.classList.toggle("is-victory","victory"===t),n.classList.toggle("is-defeat","defeat"===t),r.textContent="victory"===t?"VICTOIRE":"defeat"===t?"D√âFAITE":"√âGALIT√â",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:900;if(_){T=!0;var t=_.volume,n=performance.now(),r=function(a){if(T){var i=Math.min(1,(a-n)/e);_.volume=t*(1-i),i<1?requestAnimationFrame(r):(_.pause(),_.volume=t,T=!1)}};requestAnimationFrame(r)}}(1200),"victory"===t){var l=window.SFX_VICTORY_URL;if(l)try{var s=new Audio(l);s.volume=.7,s.loop=!1,s.play().catch(function(){})}catch(e){}}else"defeat"===t&&U(window.SFX_DEFEAT_URL,.7,"defeat",200);var u=!1,d=null;o&&o.addEventListener("click",function(){u=!u,o.setAttribute("aria-pressed",u?"true":"false"),u&&function(e){try{if(!u)return;d||(d=new(window.AudioContext||window.webkitAudioContext));var t=d.currentTime;("victory"===e?[523,659,784]:"defeat"===e?[392,349,261]:[440,440,440]).forEach(function(e,n){var r=d.createOscillator(),a=d.createGain();r.type="sine",r.frequency.value=e,r.connect(a),a.connect(d.destination);var i=t+.18*n;a.gain.setValueAtTime(.001,i),a.gain.exponentialRampToValueAtTime(.2,i+.02),a.gain.exponentialRampToValueAtTime(.001,i+.3),r.start(i),r.stop(i+.32)})}catch(e){console.debug("audio failed",e)}}(t)});var m=function(){return n.classList.add("is-hidden")};i&&i.addEventListener("click",m,{once:!0}),null===(c=n.querySelector(".result-veil"))||void 0===c||c.addEventListener("click",m,{once:!0})}}else!function(e){switch(e.t){case"fx":try{var t=Array.isArray(e.at)?e.at:null;if(!t)break;var n=I(t[0],t[1]);if(!n)break;var r=e.kind||"default",i=window.FX_URLS&&window.FX_URLS[r]||window.FX_URLS&&window.FX_URLS.default;if(!i)break;var o=document.createElement("div");o.className="fx fx--"+r;var c=document.createElement("img");c.alt=r,c.src=a(i),o.appendChild(c),n.appendChild(o);var l=Math.max(200,Math.min(4e3,parseInt(e.dur||1e3,10)));setTimeout(function(){o.remove()},l)}catch(e){}break;case"move":var s=w.get(e.id);if(!s)break;var u=I(e.to[0],e.to[1]);if(!u)break;u.appendChild(s.el),s.x=e.to[0],s.y=e.to[1];break;case"attack":var d=w.get(e.att),m=w.get(e.def);if(!d||!m)break;var f=m.hp;if(m.hp=e.hp,m.shield=e.shield,void 0!==e.mana&&(d.mana=e.mana),F(m),F(d),f>0&&m.hp>0){var v=f>(m.maxHp||2*f)/2,p=m.hp<=(m.maxHp||2*f)/2;v&&p&&U(window.SFX_HALFHP_URL,.7,"half:"+m.id,400)}m.hp<=0&&(m.el.classList.add("ko"),setTimeout(function(){return m.el.remove()},120),U(window.SFX_DEATH_URL,.8,"death",150)),e.log&&H(e.log);break;case"heal":var g,y,h=w.get(e.src),b=w.get(e.dst);if(!h||!b)break;void 0!==e.mana&&(h.mana=e.mana),b.hp=Math.min(b.maxHp,(null!==(g=b.hp)&&void 0!==g?g:0)+(null!==(y=e.amount)&&void 0!==y?y:0));var S=!0===e.crit||e.amount&&b.maxHp&&e.amount>=.25*b.maxHp;U(S&&window.SFX_HEAL_CRIT_URL?window.SFX_HEAL_CRIT_URL:window.SFX_HEAL_URL,S?.8:.6,S?"healcrit":"heal",80),F(h),F(b),e.log&&H(e.log);break;case"log":e.msg&&H(e.msg)}}(h.actions[L++]),D()}})},4028:(e,t,n)=>{"use strict";n(7848),n(633),n(5188),n(1738);console.log("This log comes from assets/app.js - welcome to AssetMapper! üéâ")},5188:()=>{document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("mg-roster-track");if(e){var t=document.querySelector(".carousel__nav--prev"),n=document.querySelector(".carousel__nav--next"),r=function(t){return e.scrollBy({left:t,behavior:"smooth"})};null==t||t.addEventListener("click",function(){return r(-280)}),null==n||n.addEventListener("click",function(){return r(280)})}}),console.log("home.js")},7848:(e,t,n)=>{function r(){var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return a(u,"_invoke",function(n,r,a){var i,o,c,s=0,u=a||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return i=t,o=0,c=e,m.n=n,l}};function f(n,r){for(o=n,c=r,t=0;!d&&s&&!a&&t<u.length;t++){var a,i=u[t],f=m.p,v=i[2];n>3?(a=v===r)&&(c=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=e):i[0]<=f&&((a=n<2&&f<i[1])?(o=0,m.v=r,m.n=i[1]):f<v&&(a=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,m.n=v,o=0))}if(a||n>1)return l;throw d=!0,r}return function(a,u,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,v),o=u,c=v;(t=o<2?e:c)||!d;){i||(o?o<3?(o>1&&(m.n=-1),f(o,c)):m.n=c:m.v=c);try{if(s=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=e}else if((t=(d=m.n<0)?c:n.call(r,m))!==l)break}catch(t){i=e,o=1,c=t}finally{s=1}}return{value:t,done:d}}}(n,i,o),!0),u}var l={};function s(){}function u(){}function d(){}t=Object.getPrototypeOf;var m=[][i]?t(t([][i]())):(a(t={},i,function(){return this}),t),f=d.prototype=s.prototype=Object.create(m);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=d,a(f,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,o,"GeneratorFunction"),a(f),a(f,o,"Generator"),a(f,i,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:v}})()}function a(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}a=function(e,t,n,r){function o(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},a(e,t,n,r)}function i(e,t,n,r,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function c(e){i(o,r,a,c,l,"next",e)}function l(e){i(o,r,a,c,l,"throw",e)}c(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return c}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function s(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n(2675),n(9463),n(2259),n(6280),n(6918),n(8706),n(2008),n(113),n(1629),n(3418),n(4346),n(3792),n(2062),n(4114),n(4782),n(4554),n(739),n(3288),n(4170),n(2010),n(3110),n(6033),n(2892),n(9085),n(9904),n(4185),n(5506),n(875),n(9432),n(3548),n(287),n(6099),n(3362),n(7495),n(906),n(8781),n(1415),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(7764),n(5440),n(8992),n(4520),n(2577),n(3949),n(1454),n(3500),n(2953),n(6031),document.addEventListener("DOMContentLoaded",function(){var e,t=(window.ASSET_BASE||"/").replace(/\/?$/,"/"),n=function(e){return t+String(e||"").replace(/^\/+/,"")},a=window.matchMedia&&window.matchMedia("(pointer: coarse)").matches||"ontouchstart"in window;console.log("Team Builder script loaded!",{ASSET_BASE:t});var i=document.getElementById("owned-girls-json"),u=document.getElementById("suggested-girls-json");if(i){var d=JSON.parse(i.textContent||"[]"),m=u?JSON.parse(u.textContent||"[]"):[],f=document.getElementById("pick-grid"),v=document.getElementById("bench-grid"),p=document.getElementById("board"),g=document.getElementById("items-grid"),y=document.getElementById("btn-reroll"),h=document.getElementById("reroll-count"),b=document.getElementById("btn-lock"),S=document.getElementById("team-bonuses"),w=document.getElementById("search-skeleton"),E=document.querySelector(".tb-hint"),L=null,_=new Map,A=new Map,T=Array.isArray(window.ITEMS)?window.ITEMS:[],M={type:null,data:null,el:null},I=function(e){return Math.floor(Math.random()*e)},x=function(e,t){return"".concat(e,",").concat(t)},k=function(e){if(!e.length)return[];if(e.length<=4)return s(e);for(var t=new Set,n=[];n.length<4&&t.size<e.length;){var r=I(e.length);t.has(r)||(t.add(r),n.push(e[r]))}return n},C=k(T);p.addEventListener("dragover",function(e){return e.preventDefault()}),p.addEventListener("drop",function(e){e.preventDefault();var t=e.target.closest(".cell");if(t){var n=t.dataset,r=n.x,a=n.y,i=x(r,a);if(document.querySelector(".tb-card.dragging, .chip.dragging, .tb-item.dragging")){var o=e.dataTransfer.getData("text/plain")||"{}",s={};try{s=JSON.parse(o)}catch(e){}if(!s||"item"!==s.__type){var u,d=l(_);try{for(d.s();!(u=d.n()).done;){var m=c(u.value,2),f=m[0];if(m[1].girl.id===s.id){_.delete(f);var g=p.querySelector('.cell[data-x="'.concat(f.split(",")[0],'"][data-y="').concat(f.split(",")[1],'"]'));g&&(g.innerHTML="")}}}catch(e){d.e(e)}finally{d.f()}if(_.has(i)||!(_.size>=4)){if(_.has(i)){var y=_.get(i);null!=y&&y.el&&(v.appendChild(N(y.girl,{source:"bench"})),A.set(y.girl.id,v.lastElementChild)),_.delete(i)}var h=R(s);t.innerHTML="",t.appendChild(h),_.set(i,{girl:s,el:h,itemId:null}),U()}}}}}),p.addEventListener("click",function(e){var t=e.target.closest(".cell");if(t)if("girl"!==M.type)if("item"!==M.type);else{var r=x(t.dataset.x,t.dataset.y),a=_.get(r);if(!a)return;a.itemId=M.data.id;var i=a.el.querySelector(".chip-item"),o=(window.ITEMS||[]).find(function(e){return String(e.id)===String(M.data.id)});if(i&&o){var s=o.desc?"".concat(o.name," ‚Äî ").concat(o.desc):o.name;i.innerHTML='<img class="chip-item-img" src="'.concat(n(o.img),'" alt="').concat(o.name,'" title="').concat(s,'">');var u=i.querySelector(".chip-item-img");u&&(u.classList.add("flash"),setTimeout(function(){return u.classList.remove("flash")},600))}q()}else{var d=function(e,t){if(!t)return!1;var n,r=t.dataset,a=r.x,i=r.y,o=x(a,i),s=l(_);try{for(s.s();!(n=s.n()).done;){var u=c(n.value,2),d=u[0];if(u[1].girl.id===e.id){_.delete(d);var m=p.querySelector('.cell[data-x="'.concat(d.split(",")[0],'"][data-y="').concat(d.split(",")[1],'"]'));m&&(m.innerHTML="")}}}catch(e){s.e(e)}finally{s.f()}if(!_.has(o)&&_.size>=4)return!1;if(_.has(o)){var f=_.get(o);null!=f&&f.el&&(v.appendChild(N(f.girl,{source:"bench"})),A.set(f.girl.id,v.lastElementChild)),_.delete(o)}var g=R(e);return t.innerHTML="",t.appendChild(g),_.set(o,{girl:e,el:g,itemId:null}),U(),!0}(M.data,t);d&&q()}}),document.addEventListener("click",function(e){var t,n;(null===(t=(n=e.target).closest)||void 0===t?void 0:t.call(n,".tb-card, .tb-item, .tb-board .cell, .tb-board, .tb-pick__grid, .tb-bench__grid"))||q()}),v.addEventListener("dragover",function(e){return e.preventDefault()}),v.addEventListener("drop",function(e){e.preventDefault();var t,n=JSON.parse(e.dataTransfer.getData("text/plain")||"{}"),r=l(_);try{for(r.s();!(t=r.n()).done;){var a=c(t.value,2),i=a[0];if(a[1].girl.id===n.id){var o=p.querySelector('.cell[data-x="'.concat(i.split(",")[0],'"][data-y="').concat(i.split(",")[1],'"]'));o&&(o.innerHTML=""),_.delete(i);break}}}catch(e){r.e(e)}finally{r.f()}if(!A.has(n.id)){var s=N(n,{source:"bench"});v.appendChild(s),A.set(n.id,s)}U()}),p.addEventListener("drop",function(e){var t=e.dataTransfer.getData("text/plain")||"";if(t){var r;try{r=JSON.parse(t)}catch(e){r=null}if(r&&"item"===r.__type){var a=e.target.closest(".cell");if(a){var i=x(a.dataset.x,a.dataset.y),o=_.get(i);if(o){o.itemId=r.id;var c=o.el.querySelector(".chip-item"),l=(window.ITEMS||[]).find(function(e){return String(e.id)===String(r.id)});if(c&&l){var s=l.desc?"".concat(l.name," ‚Äî ").concat(l.desc):l.name;c.innerHTML='<img class="chip-item-img" src="'.concat(n(l.img),'" alt="').concat(l.name,'" title="').concat(s,'">');var u=c.querySelector(".chip-item-img");u&&(u.classList.add("flash"),setTimeout(function(){return u.classList.remove("flash")},600))}L&&l&&(L.textContent="".concat(l.name," ‚Üí ").concat(o.girl.name),setTimeout(function(){L&&(L.style.display="none")},850))}}}}}),document.addEventListener("dragover",function(e){L&&"block"===L.style.display&&(L.style.left="".concat(e.clientX,"px"),L.style.top="".concat(e.clientY,"px"))});var O=null,j=null;b.addEventListener("click",o(r().m(function e(){var t,n,a,i,l,s,u,d,m,f,v,p,g,y;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return w&&(w.classList.remove("is-hidden"),w.classList.add("is-visible")),l=Array.from(_.entries()).map(function(e){var t,n=c(e,2),r=n[0],a=n[1],i=c(r.split(",").map(Number),2),o=i[0],l=i[1],s=null!==(t=a.itemId)&&void 0!==t?t:null;return s?{id:a.girl.id,x:o,y:l,item:String(s)}:{id:a.girl.id,x:o,y:l}}),s=null!==(t=null===(n=window.MM)||void 0===n?void 0:n.start)&&void 0!==t?t:"/matchmaking/start",u=null!==(a=null===(i=window.MM)||void 0===i?void 0:i.status)&&void 0!==a?a:"/matchmaking/status/__ID__",d=function(e){return u.replace("__ID__",String(e))},console.log("Calling START_URL =",s),e.p=1,e.n=2,fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:JSON.stringify({lineup:l})});case 2:return m=e.v,e.n=3,m.text();case 3:f=e.v;try{v=JSON.parse(f)}catch(e){v=null}if(console.log("matchmaking/start ->",m.status,null!=v?v:f),m.ok){e.n=4;break}return alert("Matchmaking failed (".concat(m.status,"):\n").concat(null!==(p=null===(g=v)||void 0===g?void 0:g.error)&&void 0!==p?p:f)),e.a(2);case 4:if(v&&("matched"===v.status||"queued"===v.status)){e.n=5;break}return alert("R√©ponse inattendue:\n"+(v?JSON.stringify(v):f)),e.a(2);case 5:if("matched"!==v.status){e.n=6;break}return window.location.href="/match/".concat(v.matchId),e.a(2);case 6:O=v.ticketId,b.disabled=!0,b.textContent="üîé Recherche en cours‚Ä¶",j=setInterval(o(r().m(function e(){var t,n;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch(d(O),{credentials:"same-origin"});case 1:return t=e.v,e.n=2,t.json();case 2:n=e.v,console.log("matchmaking/status ->",n),"matched"===n.status&&(clearInterval(j),w&&(w.classList.remove("is-visible"),w.classList.add("is-hidden")),window.location.href="/match/".concat(n.matchId));case 3:return e.a(2)}},e)})),5e3),e.n=8;break;case 7:e.p=7,y=e.v,console.error(y),alert("Erreur r√©seau: "+y.message),w&&(w.classList.remove("is-visible"),w.classList.add("is-hidden"));case 8:return e.a(2)}},e,null,[[1,7]])}))),D(),H(),J();var B=Number(null!==(e=window.REROLLS_LEFT)&&void 0!==e?e:3),P=function(){h&&(h.textContent="(".concat(B," restant").concat(B>1?"s":"",")")),y&&(y.disabled=B<=0)};P(),y&&y.addEventListener("click",o(r().m(function e(){var t,n,a;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!(B<=0)){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,fetch(window.REROLL_DEC_URL,{method:"POST",credentials:"same-origin"});case 2:return n=e.v,e.n=3,n.json();case 3:a=e.v,B=Number(null!==(t=null==a?void 0:a.left)&&void 0!==t?t:B),e.n=5;break;case 4:e.p=4,e.v;case 5:P(),q(),D(),C=k(T),H();case 6:return e.a(2)}},e,null,[[1,4]])})))}function q(){M.el&&M.el.classList.remove("is-selected"),M={type:null,data:null,el:null},p.classList.remove("is-placing","is-equipping"),document.querySelectorAll(".tb-item.is-selected").forEach(function(e){return e.classList.remove("is-selected")}),E&&a&&(E.textContent="Place exactement 4 h√©ro√Ønes.")}function H(){if(g){if(g.innerHTML="",!T.length){var e=document.createElement("div");return e.className="tb-items__empty",e.textContent="Ajoute des images dans public/images/items/",void g.appendChild(e)}C.forEach(function(e){var t=document.createElement("button");t.type="button",t.className="tb-item",t.setAttribute("data-item-id",e.id);var r=e.desc?"".concat(e.name," ‚Äî ").concat(e.desc):e.name;t.setAttribute("title",r),t.setAttribute("aria-label",r),t.draggable=!a,t.innerHTML='<img src="'.concat(n(e.img),'" alt="').concat(e.name,'">'),t.addEventListener("dragstart",function(n){t.classList.add("dragging"),n.dataTransfer.setData("text/plain",JSON.stringify({__type:"item",id:e.id}));var r=L||((L=document.createElement("div")).className="drag-tip",Object.assign(L.style,{position:"fixed",zIndex:99999,pointerEvents:"none",background:"rgba(26, 24, 44, 0.9)",color:"#fff",padding:"6px 10px",borderRadius:"10px",border:"1px solid rgba(255,255,255,.2)",boxShadow:"0 6px 20px rgba(0,0,0,.35)",fontSize:"12px",transform:"translate(-50%, -140%)",whiteSpace:"nowrap"}),document.body.appendChild(L),L);r.textContent="".concat(e.name," ‚Üí (d√©pose sur une h√©ro√Øne)"),r.style.display="block"}),t.addEventListener("dragend",function(){t.classList.remove("dragging"),L&&(L.style.display="none")}),t.addEventListener("click",function(){var n,r;t.classList.contains("is-selected")?q():(n=e,r=t,q(),M={type:"item",data:n,el:r},r&&r.classList.add("is-selected"),p.classList.add("is-equipping"),E&&a&&(E.textContent="Tape une h√©ro√Øne sur le plateau pour lui attribuer l'objet."))}),g.appendChild(t)})}}function N(e,t){var r,i,o=t.source,c=document.createElement("div");c.className="tb-card tb-card--".concat(e.class),c.draggable=!a,c.dataset.id=e.id,c.dataset.source=o,c.innerHTML='\n      <button class="tb-card__bench-btn" type="button" title="Ajouter au banc" aria-label="Ajouter au banc">üß∫</button>\n      <div class="tb-card__img">\n        <img src="'.concat(n(e.img),'" alt="').concat(e.name,'">\n      </div>\n      <div class="tb-card__meta">\n        <div class="tb-card__name">').concat(e.name,'</div>\n        <div class="tb-card__tags">\n          <span class="tag ').concat(F(e.class),'">').concat(function(e){switch(e){case"dps_melee":return"DPS C√†C";case"dps_ranged":return"DPS distance";case"tank":return"Tank";case"healer":return"Healer";default:return e}}(e.class),'</span>\n          <span class="tag tag-family">').concat(null!==(r=e.family)&&void 0!==r?r:"",'</span>\n        </div>\n      </div>\n      <div class="tb-card__stats">\n        <span>PV ').concat(e.pdv,"</span>\n        <span>ATK ").concat(e.atk,"</span>\n        <span>PRC ").concat(Math.round(100*(null!==(i=e.chance_atk)&&void 0!==i?i:0)),"%</span>\n      </div>\n    ");var l=c.querySelector(".tb-card__bench-btn");return null==l||l.addEventListener("click",function(t){t.stopPropagation(),c.parentElement!==v&&(v.appendChild(c),A.set(e.id,c),U())}),c.addEventListener("dragstart",function(t){t.dataTransfer.setData("text/plain",JSON.stringify(e)),requestAnimationFrame(function(){return c.classList.add("dragging")})}),c.addEventListener("dragend",function(){return c.classList.remove("dragging")}),c.addEventListener("click",function(t){var n;"item"!==M.type&&("girl"===M.type&&(null===(n=M.data)||void 0===n?void 0:n.id)===e.id?q():function(e,t){q(),M={type:"girl",data:e,el:t},t&&t.classList.add("is-selected"),p.classList.add("is-placing"),E&&a&&(E.textContent="S√©lectionne une case du plateau pour placer la h√©ro√Øne.")}(e,c))}),c.addEventListener("dblclick",function(){c.parentElement===v?(A.delete(e.id),f?f.appendChild(c):c.remove()):(v.appendChild(c),A.set(e.id,c)),U()}),c}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=document.createElement("div");r.className="chip ".concat(F(e.class)),r.title=e.name,r.draggable=!a;var i="number"==typeof e.focus_y?"".concat(e.focus_y,"%"):"10%";r.innerHTML='\n      <img class="chip-avatar" src="'.concat(n(e.img),'" alt="').concat(e.name,'" style="object-position:center ').concat(i,';">\n      <span class="chip-item"></span>\n    ');var o=r.querySelector(".chip-item");if(t){var c=(window.ITEMS||[]).find(function(e){return String(e.id)===String(t)});if(c&&o){var l=c.desc?"".concat(c.name," ‚Äî ").concat(c.desc):c.name;o.innerHTML='<img class="chip-item-img" src="'.concat(n(c.img),'" alt="').concat(c.name,'" title="').concat(l,'">')}}return o&&o.addEventListener("click",function(e){var t;e.stopPropagation();var n=null===(t=r.parentElement)||void 0===t?void 0:t.closest(".cell");if(n){var a=x(n.dataset.x,n.dataset.y),i=_.get(a);i&&(i.itemId=null,o.innerHTML="")}}),r.addEventListener("dragstart",function(t){t.dataTransfer.setData("text/plain",JSON.stringify(e)),requestAnimationFrame(function(){return r.classList.add("dragging")})}),r.addEventListener("dragend",function(){return r.classList.remove("dragging")}),r.addEventListener("click",function(){var t,a=null===(t=r.parentElement)||void 0===t?void 0:t.closest(".cell");if(a)if("item"!==M.type){var i=x(a.dataset.x,a.dataset.y);if(_.delete(i),a.innerHTML="",!A.has(e.id)){var o=N(e,{source:"bench"});v.appendChild(o),A.set(e.id,o)}U()}else{var c=x(a.dataset.x,a.dataset.y),l=_.get(c);if(l){l.itemId=M.data.id;var s=r.querySelector(".chip-item"),u=(window.ITEMS||[]).find(function(e){return String(e.id)===String(M.data.id)});if(s&&u){var d=u.desc?"".concat(u.name," ‚Äî ").concat(u.desc):u.name;s.innerHTML='<img class="chip-item-img" src="'.concat(n(u.img),'" alt="').concat(u.name,'" title="').concat(d,'">');var m=s.querySelector(".chip-item-img");m&&(m.classList.add("flash"),setTimeout(function(){return m.classList.remove("flash")},600))}q()}}}),r}function D(){f.innerHTML="";var e=m.length?s(m):s(d);if(0!==e.length){for(;e.length<4;)e=e.concat(e);for(var t=new Set(Array.from(A.keys())),n=e.filter(function(e){return!t.has(e.id)}),r=[],a=new Set,i=Math.min(4,n.length);r.length<i&&a.size<n.length;){var o=Math.floor(Math.random()*n.length);a.has(o)||(a.add(o),r.push(n[o]))}r.forEach(function(e){return f.appendChild(N(e,{source:"pick"}))})}}function F(e){switch(e){case"dps_melee":return"tag-melee";case"dps_ranged":return"tag-ranged";case"tank":return"tag-tank";case"healer":return"tag-heal";default:return""}}function U(){b.disabled=4!==_.size,J()}function J(){if(S){var e=function(){var e,t={},n=l(_);try{for(n.s();!(e=n.n()).done;){var r=(c(e.value,2)[1].girl.family||"").toLowerCase();r&&(t[r]=(t[r]||0)+1)}}catch(e){n.e(e)}finally{n.f()}for(var a={},i=0,o=Object.entries(t);i<o.length;i++){var s=c(o[i],2),u=s[0],d=s[1],m=d>=4?4:d>=3?3:d>=2?2:0;0!==m&&(a[u]={n:d,tier:m})}return a}();S.innerHTML="";var t={soleil:"‚òÄÔ∏è",lune:"üåô",nature:"üçÉ",idole:"üéµ",ombre:"üåë",arcane:"‚ú®",etoile:"‚≠ê",ocean:"üåä"};Object.entries(e).forEach(function(e){var n=c(e,2),r=n[0],a=n[1],i=a.tier,o=a.n,l=document.createElement("li");l.className="bonus-item fam-".concat(r," tier-").concat(i);var s=r.charAt(0).toUpperCase()+r.slice(1),u=function(e,t,n){var r={soleil:{2:"ATK +5%",3:"Pr√©cision +5%",4:"Crit +5%"},lune:{2:"Esquive +3%",3:"Esquive +2% & Mana +10",4:"Bouclier +10"},nature:{2:"PV +5%",3:"Bouclier +15",4:"PV +5%"},idole:{2:"Crit +5%",3:"ATK +5%",4:"Mana +10"},ombre:{2:"Esquive +5%",3:"Pr√©cision +5%",4:"Bouclier +15"},arcane:{2:"Pr√©cision +5%",3:"Mana +15",4:"Crit +5%"},etoile:{2:"Pr√©cision +3%",3:"Crit +5%",4:"ATK +5%"},ocean:{2:"Esquive +3%",3:"Mana +10",4:"Pr√©cision +5%"}},a=r[e]&&r[e][t]?r[e][t]:"Palier ".concat(t),i=e.charAt(0).toUpperCase()+e.slice(1);return"".concat(i," x").concat(n," ‚Äî ").concat(a)}(r,i,o).split(" ‚Äî ").pop(),d=Math.min(100,Math.round(o/4*100));l.innerHTML='\n        <span class="fam-icon" aria-hidden="true">'.concat(t[r]||"‚úß",'</span>\n        <span class="fam-name">').concat(s,'</span>\n        <span class="count">x').concat(o,'</span>\n        <div class="gauge" role="progressbar" aria-valuemin="0" aria-valuemax="4" aria-valuenow="').concat(o,'">\n          <div class="bar" style="width:').concat(d,'%"></div>\n        </div>\n        <span class="effect">').concat(u,"</span>\n      "),S.appendChild(l)})}}})}},e=>{e.O(0,[160],()=>{return t=4028,e(e.s=t);var t});e.O()}]);