@use '../base/variables' as v;

.page-match {
  /* Page-level background — rosy but darker */
  min-height: 100vh;
  background:
  radial-gradient(1100px 520px at 60% -10%, rgba(255, 185, 232, .26), transparent 70%),
  radial-gradient(900px 420px at 0% 0%, rgba(152, 120, 250, .24), transparent 60%),
  linear-gradient(180deg, #e6d6f1 0%, #d9cbf0 100%);
  .container { width: min(1200px, 94%); margin-inline:auto; }
  .match__header {
    display:flex; align-items:center; justify-content:space-between;
    color: v.$color-text; margin: 1rem 0;
    h1 { margin:0; font-family: v.$font-display; letter-spacing:.6px; text-shadow:0 2px 12px rgba(0,0,0,.45); }
    .btn { margin-left:.4rem; }
    /* Make header buttons readable on light rosy background */
    .btn {
      color: #2a1a3f; /* darker text for contrast */
    }
    .btn.btn-ghost {
      background: rgba(255,255,255,.72);
      border-color: rgba(0,0,0,.12);
      color: #2a1a3f;
      box-shadow: 0 2px 8px rgba(0,0,0,.06);
    }
    .btn.btn-ghost:hover {
      background: rgba(255,255,255,.88);
      border-color: rgba(0,0,0,.18);
      box-shadow: 0 6px 16px rgba(0,0,0,.10);
    }
  }
  .match__layout {
    display:grid; grid-template-columns: 220px 1fr 220px; gap: 1rem;
    @media (max-width: 980px) { grid-template-columns: 1fr; }
  }

  .hud {
    background:
      linear-gradient(rgba(255,255,255,.06), rgba(255,255,255,.06)) padding-box,
      linear-gradient(120deg, v.$color-primary, v.$color-accent) border-box;
    border:1px solid transparent; border-radius:14px; padding:.7rem;
    color: v.$color-text;
    h3 { margin:.1rem 0 .6rem; color: v.$color-accent; }
    ul { list-style:none; padding:0; margin:0; display:grid; gap:.4rem; }
    li { display:flex; align-items:center; gap:.6rem; background:rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.2); border-radius:12px; padding:.4rem .6rem;
      img { width:32px; height:32px; border-radius:8px; object-fit:cover; box-shadow: 0 2px 8px rgba(0,0,0,.25); }
      span { flex:1; font-weight:700; }
      em { font-style:normal; opacity:.95; }
    }
  }

  .board-wrap { display:flex; flex-direction:column; gap:.6rem; }
  .board {
    display:grid; gap:.45rem; padding:.6rem;
    /* Darker, softly greyed background */
    background: linear-gradient(180deg, rgba(205, 196, 222, .96), rgba(190, 182, 210, .98)), #c7bfdc;
    border:1px solid rgba(0,0,0,.12); border-radius:16px;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.22);
    grid-template-columns: repeat(7, 1fr);
    /* slightly taller cells for nicer portrait display */
    grid-template-rows: repeat(4, 96px);
  }
  .cell {
    background:
      linear-gradient(rgba(255,255,255,.22), rgba(255,255,255,.22)) padding-box,
      linear-gradient(120deg, rgba(0,0,0,.12), rgba(0,0,0,.08)) border-box;
    border:1px solid transparent; border-radius:14px; position:relative; overflow:hidden;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.2);
  .fx { position:absolute; inset:0; z-index:6; pointer-events:none; display:flex; align-items:center; justify-content:center; }
  .fx img { max-width: 100%; max-height: 100%; object-fit: contain; image-rendering:auto; }
  }

  /* Team gauges (HP & Mana) */
  .gauges { display:grid; grid-template-columns: 1fr 1fr; gap:.6rem; align-items:center; }
  .gauge { display:grid; grid-template-columns: 74px 1fr auto; gap:.5rem; align-items:center; }
  .gauge__label { font-weight:900; color: v.$color-accent; text-shadow: 0 1px 6px rgba(0,0,0,.15); }
  .gauge__bar { position:relative; height: 14px; border-radius: 999px; overflow:hidden;
    background:
      linear-gradient(rgba(255,255,255,.10), rgba(255,255,255,.10)) padding-box,
      linear-gradient(120deg, v.$color-primary, v.$color-accent) border-box;
    border:1px solid transparent;
  }
  .gauge__fill { position:absolute; inset:0 100% 0 0; border-radius:999px; transition: width .25s ease;
    background: linear-gradient(90deg, rgba(142,240,255,.95), rgba(255,154,209,.95));
    box-shadow: inset 0 0 12px rgba(255,255,255,.35);
  }
  .gauge--hp .gauge__fill { background: linear-gradient(90deg, #8ef0ff, #ff9ad1); }
  .gauge--mana .gauge__fill { background: linear-gradient(90deg, #a7b3ff, #d0a5ff); }
  .gauge__value { font-weight:800; color:#2a1a3f; background: rgba(255,255,255,.72); border:1px solid rgba(0,0,0,.12);
    padding:.12rem .45rem; border-radius: 999px; box-shadow: 0 2px 8px rgba(0,0,0,.06); }

  .unit {
    /* Centered, image-only figure on the board */
    position:absolute; inset:0; display:grid; place-items:center; pointer-events:none;
    background: transparent; border:none; box-shadow: none;

    /* Hide numeric badges on the board for a clean look */
    .hp, .shield, .mana { display:none !important; }

    img {
      width: 74px; height: 74px; border-radius: 14px; object-fit: cover; display:block;
      /* soft depth and glow suitable for light background */
      box-shadow: 0 6px 18px rgba(0,0,0,.18);
      outline: 3px solid transparent;
      image-rendering: auto;
    }
  /* per-unit bars below portrait */
  .u-bars { position:absolute; left:50%; transform: translateX(-50%); bottom:6px; width: 82px; display:grid; gap:3px; z-index:5; }
  .u-bar { position:relative; height:6px; background: rgba(0,0,0,.28); border-radius: 999px; overflow:hidden; box-shadow: inset 0 0 0 1px rgba(255,255,255,.12); }
  .u-bar > span { position:absolute; inset:0 100% 0 0; border-radius: 999px; transition: width .22s ease; }
  .u-bar--hp > span { background: linear-gradient(90deg, #8ef0ff, #ff9ad1); }
  .u-bar--mana > span { background: linear-gradient(90deg, #a7b3ff, #d0a5ff); }
    &.unit--ally img  { outline-color: rgba(120,220,255,.7); }
    &.unit--enemy img { outline-color: rgba(255,120,180,.7); }
    &.ko img { opacity:.45; filter:grayscale(1); }
  }

  .log {
    /* Kawaii recap panel */
    position: relative;
    height: 180px; overflow:auto;
    background:
      /* softer, greyer-lilac inner fill */
      linear-gradient(180deg, rgba(78, 74, 96, .92), rgba(72, 68, 90, .92)) padding-box,
      linear-gradient(120deg, #ff9ad1, #b094ff) border-box; /* pastel border */
    border:1px solid transparent;
    border-radius: 16px; padding:.8rem;
  color: #ff9ad1; /* pink like the unit frame accents */
    font-size: .96rem; line-height: 1.45;
    text-shadow: 0 1px 0 rgba(0,0,0,.2);
    box-shadow: 0 10px 30px rgba(0,0,0,.28), inset 0 0 0 1px rgba(255,255,255,.05);
  }
  /* floating sparkles overlay */
  .log::after {
    content:""; position:absolute; inset:0; pointer-events:none; mix-blend-mode: screen; opacity:.35;
    background-image:
      radial-gradient(4px 4px at 8% 24%, rgba(255,255,255,.9), rgba(255,255,255,0) 60%),
      radial-gradient(3px 3px at 22% 76%, rgba(255,154,209,.9), rgba(255,154,209,0) 60%),
      radial-gradient(3px 3px at 42% 36%, rgba(174,143,255,.9), rgba(174,143,255,0) 60%),
      radial-gradient(3px 3px at 58% 20%, rgba(255,209,243,.9), rgba(255,209,243,0) 60%),
      radial-gradient(4px 4px at 72% 70%, rgba(142,240,255,.9), rgba(142,240,255,0) 60%),
      radial-gradient(3px 3px at 86% 34%, rgba(255,120,180,.9), rgba(255,120,180,0) 60%);
    animation: sparkle-drift 10s linear infinite;
  }
  @keyframes sparkle-drift { 0% { background-position: 0 0, 0 0, 0 0, 0 0, 0 0, 0 0; }
    50% { background-position: 10px -8px, -16px 12px, 8px 10px, -10px 8px, 14px -6px, -8px 6px; }
    100% { background-position: 0 0, 0 0, 0 0, 0 0, 0 0, 0 0; } }
  .log > div { position:relative; padding:.18rem 0 .18rem 1.4rem; opacity:.97; }
  /* cute bullets */
  .log > div::before { content: "✦"; position:absolute; left:.35rem; top:.1rem; font-size:.95rem;
    background: linear-gradient(90deg, #ff9ad1, #b094ff); -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow: 0 0 10px rgba(255,154,209,.45);
  }
  .log > div:nth-child(2n)::before { content: "❤"; transform: translateY(-1px); font-size:.9rem; text-shadow: 0 0 10px rgba(255,120,180,.5); }
  .log::-webkit-scrollbar { width: 10px; }
  .log::-webkit-scrollbar-thumb { background: linear-gradient(180deg, rgba(181,114,246,.9), rgba(255,99,216,.9)); border-radius: 8px; }
  .log::-webkit-scrollbar-track { background: rgba(255,255,255,.06); border-radius: 8px; }

  /* Result overlay (Victory/Defeat) */
  .result-overlay { position: fixed; inset: 0; z-index: 3000; display:none; place-items:center; }
  .result-overlay.is-hidden { display:none; }
  .result-overlay:not(.is-hidden) { display:grid; }
  .result-veil { position:absolute; inset:0; background: radial-gradient(70% 110% at 50% 40%, rgba(20,10,35,.7), rgba(10,6,20,.85)); backdrop-filter: blur(2px); }
  .result-frame { position: relative; z-index:1; min-width: min(640px, 92vw); border-radius: 18px; padding: 1.2rem 1.6rem;
    background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.18);
    box-shadow: 0 24px 60px rgba(0,0,0,.45), inset 0 0 18px rgba(255,255,255,.08);
    animation: pop-in .35s ease-out; }
  .result-text { text-align:center; font-weight: 1000; letter-spacing: .11em;
    font-size: clamp(2.1rem, 6.2vw, 3.6rem); line-height: 1.08; margin: .45rem 0;
    background: linear-gradient(90deg, v.$color-primary, v.$color-accent);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 3px 12px rgba(0,0,0,.55), 0 0 28px rgba(167,107,255,.55); }
  .result-actions { display:flex; justify-content:center; margin-top:.7rem; }
  .result-actions .btn { font-weight:800; padding:.55rem 1rem; }
  .sound-toggle { position:absolute; right:.6rem; top:.6rem; background: rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.22);
    border-radius: 999px; padding: .3rem .5rem; color: #fff; cursor: pointer; }
  .sound-toggle[aria-pressed="true"] { background: rgba(255,255,255,.18); }
  .result-stars { position:absolute; inset:0; pointer-events:none; overflow:hidden; }
  .result-stars .tw { position:absolute; width:8px; height:8px; border-radius:50%;
    background: radial-gradient(circle, #fff, rgba(255,255,255,.1));
    box-shadow: 0 0 14px rgba(255,255,255,.9), 0 0 26px rgba(167,107,255,.55);
    animation: twinkle 2.2s ease-in-out infinite; opacity:0; }
  .result-stars .tw:nth-child(1){ left:12%; top:20%; animation-delay:0s; }
  .result-stars .tw:nth-child(2){ left:24%; top:68%; animation-delay:.2s; }
  .result-stars .tw:nth-child(3){ left:40%; top:38%; animation-delay:.4s; }
  .result-stars .tw:nth-child(4){ left:58%; top:22%; animation-delay:.6s; }
  .result-stars .tw:nth-child(5){ left:72%; top:66%; animation-delay:.8s; }
  .result-stars .tw:nth-child(6){ left:84%; top:30%; animation-delay:1s; }
  .result-stars .tw:nth-child(7){ left:18%; top:84%; animation-delay:1.2s; }
  .result-stars .tw:nth-child(8){ left:50%; top:76%; animation-delay:1.4s; }
  .result-stars .tw:nth-child(9){ left:88%; top:50%; animation-delay:1.6s; }
  @keyframes twinkle { 0%,100%{ opacity:0; transform:scale(.6);} 50%{ opacity:1; transform:scale(1);} }
  .result-overlay.is-victory .result-text {
    background: linear-gradient(90deg, #8ef0ff, #ffd1f3);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 0 28px rgba(142,240,255,.7), 0 0 36px rgba(255,209,243,.65);
  }
  .result-overlay.is-defeat .result-text {
    background: linear-gradient(90deg, #ff9fb1, #b572f6);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 0 26px rgba(255,159,177,.7), 0 0 34px rgba(181,114,246,.65);
  }
  @keyframes pop-in { from { transform: translateY(8px) scale(.98); opacity:.0; } to { transform: translateY(0) scale(1); opacity:1; } }
}
