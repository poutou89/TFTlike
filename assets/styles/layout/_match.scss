@use '../base/variables' as v;

.page-match {
  .container { width: min(1200px, 94%); margin-inline:auto; }
  .match__header {
    display:flex; align-items:center; justify-content:space-between;
    color: v.$color-text; margin: 1rem 0;
    h1 { margin:0; }
    .btn { margin-left:.4rem; }
  }
  .match__layout {
    display:grid; grid-template-columns: 220px 1fr 220px; gap: 1rem;
    @media (max-width: 980px) { grid-template-columns: 1fr; }
  }

  .hud {
    background:
      linear-gradient(rgba(255,255,255,.06), rgba(255,255,255,.06)) padding-box,
      linear-gradient(120deg, v.$color-primary, v.$color-accent) border-box;
    border:1px solid transparent; border-radius:14px; padding:.7rem;
    color: v.$color-text;
    h3 { margin:.1rem 0 .6rem; color: v.$color-accent; }
    ul { list-style:none; padding:0; margin:0; display:grid; gap:.35rem; }
    li { display:flex; align-items:center; gap:.5rem; background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.15); border-radius:10px; padding:.3rem .5rem;
      img { width:28px; height:28px; border-radius:6px; object-fit:cover; }
      span { flex:1; }
      em { font-style:normal; opacity:.9; }
    }
  }

  .board-wrap { display:flex; flex-direction:column; gap:.6rem; }
  .board {
    display:grid; gap:.35rem; padding:.5rem;
    background: rgba(10,6,20,.36); border:1px solid rgba(255,255,255,.15); border-radius:14px;
    grid-template-columns: repeat(7, 1fr);
    grid-template-rows: repeat(4, 84px);
  }
  .cell {
    background:
      linear-gradient(rgba(255,255,255,.05), rgba(255,255,255,.05)) padding-box,
      linear-gradient(120deg, rgba(255,255,255,.18), rgba(255,255,255,.08)) border-box;
    border:1px solid transparent; border-radius:12px; position:relative; overflow:hidden;
  }

  .unit {
    position:absolute; inset:6px;
    display:flex; align-items:center; gap:.35rem;
    padding:.25rem .35rem; border-radius:10px;
    background: rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.2);
    img { width:28px; height:28px; border-radius:6px; object-fit:cover; }
    .hp { font-size:.85rem; font-weight:700; }
    &.unit--ally  { box-shadow: 0 0 0 2px rgba(120,220,255,.35) inset; }
    &.unit--enemy { box-shadow: 0 0 0 2px rgba(255,120,180,.35) inset; }
    &.ko { opacity:.35; filter:grayscale(1); }
  }

  .log {
    height: 160px; overflow:auto;
    background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.15);
    border-radius: 12px; padding:.5rem; color: v.$color-text; font-size:.9rem;
  }

  /* Result overlay (Victory/Defeat) */
  .result-overlay { position: fixed; inset: 0; z-index: 3000; display:none; place-items:center; }
  .result-overlay.is-hidden { display:none; }
  .result-overlay:not(.is-hidden) { display:grid; }
  .result-veil { position:absolute; inset:0; background: radial-gradient(70% 110% at 50% 40%, rgba(20,10,35,.7), rgba(10,6,20,.85)); backdrop-filter: blur(2px); }
  .result-frame { position: relative; z-index:1; min-width: min(640px, 92vw); border-radius: 18px; padding: 1.2rem 1.6rem;
    background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.18);
    box-shadow: 0 24px 60px rgba(0,0,0,.45), inset 0 0 18px rgba(255,255,255,.08);
    animation: pop-in .35s ease-out; }
  .result-text { text-align:center; font-weight: 1000; letter-spacing: .12em;
    font-size: clamp(2rem, 6vw, 3.4rem); line-height: 1.1; margin: .4rem 0;
    background: linear-gradient(90deg, v.$color-primary, v.$color-accent);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 3px 12px rgba(0,0,0,.55), 0 0 28px rgba(167,107,255,.55); }
  .result-actions { display:flex; justify-content:center; margin-top:.6rem; }
  .result-actions .btn { font-weight:800; }
  .sound-toggle { position:absolute; right:.6rem; top:.6rem; background: rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.22);
    border-radius: 999px; padding: .3rem .5rem; color: #fff; cursor: pointer; }
  .sound-toggle[aria-pressed="true"] { background: rgba(255,255,255,.18); }
  .result-stars { position:absolute; inset:0; pointer-events:none; overflow:hidden; }
  .result-stars .tw { position:absolute; width:8px; height:8px; border-radius:50%;
    background: radial-gradient(circle, #fff, rgba(255,255,255,.1));
    box-shadow: 0 0 14px rgba(255,255,255,.9), 0 0 26px rgba(167,107,255,.55);
    animation: twinkle 2.2s ease-in-out infinite; opacity:0; }
  .result-stars .tw:nth-child(1){ left:12%; top:20%; animation-delay:0s; }
  .result-stars .tw:nth-child(2){ left:24%; top:68%; animation-delay:.2s; }
  .result-stars .tw:nth-child(3){ left:40%; top:38%; animation-delay:.4s; }
  .result-stars .tw:nth-child(4){ left:58%; top:22%; animation-delay:.6s; }
  .result-stars .tw:nth-child(5){ left:72%; top:66%; animation-delay:.8s; }
  .result-stars .tw:nth-child(6){ left:84%; top:30%; animation-delay:1s; }
  .result-stars .tw:nth-child(7){ left:18%; top:84%; animation-delay:1.2s; }
  .result-stars .tw:nth-child(8){ left:50%; top:76%; animation-delay:1.4s; }
  .result-stars .tw:nth-child(9){ left:88%; top:50%; animation-delay:1.6s; }
  @keyframes twinkle { 0%,100%{ opacity:0; transform:scale(.6);} 50%{ opacity:1; transform:scale(1);} }
  .result-overlay.is-victory .result-text {
    background: linear-gradient(90deg, #8ef0ff, #ffd1f3);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 0 28px rgba(142,240,255,.7), 0 0 36px rgba(255,209,243,.65);
  }
  .result-overlay.is-defeat .result-text {
    background: linear-gradient(90deg, #ff9fb1, #b572f6);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 0 26px rgba(255,159,177,.7), 0 0 34px rgba(181,114,246,.65);
  }
  @keyframes pop-in { from { transform: translateY(8px) scale(.98); opacity:.0; } to { transform: translateY(0) scale(1); opacity:1; } }
}
