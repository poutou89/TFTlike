{% extends 'base.html.twig' %}

{% block title %}Cr√©ation d'√©quipe{% endblock %}
{% block body_class %}page-team{% endblock %}

{% block main %}
<section class="team-builder container">
  <header class="tb-header">
    <h1>Cr√©ation d‚Äô√©quipe</h1>
    <p>Choisis 4 Magical Girls al√©atoires parmi ta collection, place-les sur le plateau, puis lance une recherche de combat.</p>
  </header>

  <div class="tb-layout">
    <!-- Colonne gauche : tirage & banc -->
    <aside class="tb-sidebar">
      <div class="tb-pick">
        <div class="tb-pick__head">
          <h2>Tirage</h2>
          <button class="btn btn-ghost" id="btn-reroll">‚Üª Re-tirer</button>
        </div>
        <div class="tb-pick__grid" id="pick-grid"><!-- cartes tirage rendues par JS --></div>
      </div>

      <div class="tb-bench">
        <h2>Banc</h2>
        <div class="tb-bench__grid" id="bench-grid"><!-- cartes bench --></div>
      </div>

      <div class="tb-legend">
        <h3>Classes</h3>
        <div class="legend-list">
          <span class="tag tag-melee">DPS C√†C</span>
          <span class="tag tag-ranged">DPS distance</span>
          <span class="tag tag-tank">Tank</span>
          <span class="tag tag-heal">Healer</span>
        </div>
      </div>
    </aside>

    <!-- Plateau -->
    <main class="tb-board">
      <h2>Plateau</h2>
      <div class="board" id="board" data-cols="7" data-rows="4">
        {# Grille 7x4, notre camp √† gauche (tout le plateau est drop OK c√¥t√© client) #}
        {% for r in 0..3 %}
          {% for c in 0..6 %}
            <div class="cell" data-x="{{ c }}" data-y="{{ r }}"></div>
          {% endfor %}
        {% endfor %}
      </div>

      <div class="tb-actions">
        <button class="btn btn-primary" id="btn-lock" disabled>üîí Verrouiller & Rechercher</button>
        <div class="tb-hint">Place exactement 4 h√©ro√Ønes.</div>
      </div>
    </main>
  </div>
</section>

{# donn√©es pour le JS #}
<script id="owned-girls-json" type="application/json">
  {{ owned_girls|json_encode()|raw }}
</script>
<script>
  window.ASSET_BASE = "{{ asset('') }}";  // <-- racine ("/"), plus "images/mg/"
  window.MM = {
    start:  "{{ path('matchmaking_start') }}",                  // e.g. /matchmaking/start
    status: "{{ path('matchmaking_status', {ticketId:'__ID__'}) }}",  // we replace __ID__ in JS
    cancel: "{{ path('matchmaking_cancel', {ticketId: 0})|replace({'/0':'/'}) }}"
  };
</script>
</script>
{% endblock %}
